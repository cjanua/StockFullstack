#.envrc
#!/bin/bash


if [ -d "venv" ]; then
    # Store the current VIRTUAL_ENV to detect changes
    old_venv="$VIRTUAL_ENV"

    # Export path to this venv
    export VIRTUAL_ENV="$PWD/venv"

    # Add venv binary path to PATH
    PATH_add "$VIRTUAL_ENV/bin"

    # Indicate venv activation in PS1 if not already handled by your shell
    if [ -z "$DIRENV_VENV_PS1" ]; then
        export DIRENV_VENV_PS1=1
        export OLD_PS1="$PS1"
        export PS1="(venv) $PS1"
    fi

    # Log activation if it's a new venv
    if [ "$old_venv" != "$VIRTUAL_ENV" ]; then
        log_status "Activated Python venv: $VIRTUAL_ENV"
    fi
else
    python -m venv venv
fi

# Optional: Export project-specific environment variables
export PYTHONPATH="$PWD:$PYTHONPATH"
export PROJECT_ROOT="$PWD"

# Optional: Set development-specific variables
export FLASK_ENV=development
export DEBUG=1

# Optional: Add local bin directory to PATH if it exists
if [ -d "$PWD/bin" ]; then
    PATH_add "$PWD/bin"
fi