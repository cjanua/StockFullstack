CUDA is available with 1 device(s)
Using device: AMD Radeon RX 7800 XT
🎯 Analyzing 9 assets: SPY, SPXS, TQQQ, SQQQ, SOXL, TSLA, NVDA, AMD, UVXY
🔄 Cache refreshed for SPY
📊 Fetching data for SPY...
🔄 Cache refreshed for SPXS
📊 Fetching data for SPXS...
🔄 Cache refreshed for TQQQ
📊 Fetching data for TQQQ...
🔄 Cache refreshed for SQQQ
📊 Fetching data for SQQQ...
🔄 Cache refreshed for SOXL
📊 Fetching data for SOXL...
🔄 Cache refreshed for TSLA
📊 Fetching data for TSLA...
🔄 Cache refreshed for NVDA
📊 Fetching data for NVDA...
🔄 Cache refreshed for AMD
📊 Fetching data for AMD...
🔄 Cache refreshed for UVXY
📊 Fetching data for UVXY...
✅ Fetched 690 rows for SPY
🚀 Training model for SPY...
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for SPY...
CACHE MISS: Running create_comprehensive_features and caching result.
PCA explained variance ratio: 1.000
✅ Generated 50 features for SPY
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for SPY...
CACHE MISS: Running create_comprehensive_features and caching result.
PCA explained variance ratio: 0.999
✅ Generated 50 features for SPY
Creating sequences from 462 data points...
Successfully created 402 sequences
Class distribution: {'Down': np.int64(152), 'Hold': np.int64(52), 'Up': np.int64(198)}
Creating sequences from 84 data points...
Successfully created 24 sequences
Class distribution: {'Down': np.int64(12), 'Hold': np.int64(1), 'Up': np.int64(11)}
Creating sequences from 462 data points...
Successfully created 402 sequences
Class distribution: {'Down': np.int64(152), 'Hold': np.int64(52), 'Up': np.int64(198)}
Creating sequences from 84 data points...
Successfully created 24 sequences
Class distribution: {'Down': np.int64(12), 'Hold': np.int64(1), 'Up': np.int64(11)}
Creating standard TradingLSTM model
TradingLSTM: input_size=50, hidden_size=128
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for SPY...
CACHE MISS: Running create_comprehensive_features and caching result.
PCA explained variance ratio: 1.000
✅ Generated 50 features for SPY
📊 Backtesting SPY...
✅ Fetched 690 rows for UVXY
🚀 Training model for UVXY...
✅ Fetched 690 rows for TSLA
🚀 Training model for TSLA...
✅ Fetched 690 rows for TQQQ
🚀 Training model for TQQQ...
✅ Fetched 690 rows for SOXL
🚀 Training model for SOXL...
✅ Fetched 690 rows for SQQQ
🚀 Training model for SQQQ...
✅ Fetched 690 rows for NVDA
🚀 Training model for NVDA...
✅ Fetched 690 rows for AMD
🚀 Training model for AMD...
CACHE MISS: Running process_features and caching result.
✅ Fetched 690 rows for SPXS
🔧 Engineering features for SPY...
🚀 Training model for SPXS...
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for UVXY...
CACHE MISS: Running create_comprehensive_features and caching result.
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for TQQQ...
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for TSLA...
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for SOXL...
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for AMD...
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for NVDA...
CACHE MISS: Running create_comprehensive_features and caching result.
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for SPXS...
CACHE MISS: Running process_features and caching result.
CACHE MISS: Running create_comprehensive_features and caching result.
CACHE MISS: Running create_comprehensive_features and caching result.
🔧 Engineering features for SQQQ...
CACHE MISS: Running create_comprehensive_features and caching result.
CACHE MISS: Running create_comprehensive_features and caching result.
CACHE MISS: Running create_comprehensive_features and caching result.
CACHE MISS: Running create_comprehensive_features and caching result.
CACHE MISS: Running create_comprehensive_features and caching result.
PCA explained variance ratio: 1.000
✅ Generated 50 features for SPY
📊 Current columns for SPY: ['open', 'high', 'low', 'close', 'volume']
📊 Backtest data shape for SPY: (84, 55)
📊 Backtest columns: ['Open', 'High', 'Low', 'Close', 'Volume', 'pca_0', 'pca_1', 'pca_2', 'pca_3', 'pca_4']...
Backtest.run:   0% 0/83 [00:00<?, ?bar/s]PCA explained variance ratio: 1.000
✅ Generated 50 features for UVXY
PCA explained variance ratio: 0.996
✅ Generated 50 features for TQQQ
PCA explained variance ratio: 0.999
✅ Generated 50 features for NVDA
PCA explained variance ratio: 0.999
✅ Generated 50 features for AMD
PCA explained variance ratio: 0.992
✅ Generated 50 features for SPXS
PCA explained variance ratio: 0.999
✅ Generated 50 features for SOXL
PCA explained variance ratio: 0.999
✅ Generated 50 features for TSLA
PCA explained variance ratio: 0.999
✅ Generated 50 features for SQQQ
                                         CACHE MISS: Running process_features and caching result.
🔧 Engineering features for TQQQ...
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for NVDA...
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for AMD...
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for UVXY...
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for SPXS...
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for TSLA...
CACHE MISS: Running create_comprehensive_features and caching result.
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for SQQQ...
CACHE MISS: Running create_comprehensive_features and caching result.
CACHE MISS: Running create_comprehensive_features and caching result.
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for SOXL...
CACHE MISS: Running create_comprehensive_features and caching result.
CACHE MISS: Running create_comprehensive_features and caching result.
CACHE MISS: Running create_comprehensive_features and caching result.
CACHE MISS: Running create_comprehensive_features and caching result.
CACHE MISS: Running create_comprehensive_features and caching result.
PCA explained variance ratio: 0.997
✅ Generated 50 features for SPXS
Creating sequences from 462 data points...
PCA explained variance ratio: 0.999
✅ Generated 50 features for NVDA
PCA explained variance ratio: 0.999
✅ Generated 50 features for AMD
PCA explained variance ratio: 0.999
✅ Generated 50 features for UVXY
PCA explained variance ratio: 0.998
✅ Generated 50 features for SOXL
PCA explained variance ratio: 0.998
✅ Generated 50 features for SQQQ
PCA explained variance ratio: 1.000
✅ Generated 50 features for TQQQ
PCA explained variance ratio: 1.000
✅ Generated 50 features for TSLA
Successfully created 402 sequences
Class distribution: {'Down': np.int64(212), 'Hold': np.int64(23), 'Up': np.int64(167)}
Creating sequences from 84 data points...
Successfully created 24 sequences
Class distribution: {'Down': np.int64(11), 'Hold': np.int64(1), 'Up': np.int64(12)}
Creating sequences from 462 data points...
Successfully created 402 sequences
Class distribution: {'Down': np.int64(212), 'Hold': np.int64(23), 'Up': np.int64(167)}
Creating sequences from 84 data points...
Successfully created 24 sequences
Class distribution: {'Down': np.int64(11), 'Hold': np.int64(1), 'Up': np.int64(12)}
Creating standard TradingLSTM model
TradingLSTM: input_size=50, hidden_size=128
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for SPXS...
CACHE MISS: Running create_comprehensive_features and caching result.
PCA explained variance ratio: 0.992
✅ Generated 50 features for SPXS
📊 Backtesting SPXS...
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for SPXS...
CACHE MISS: Running create_comprehensive_features and caching result.
Creating sequences from 462 data points...
Successfully created 402 sequences
PCA explained variance ratio: 0.999
✅ Generated 50 features for SPXS
Class distribution: {'Down': np.int64(168), 'Hold': np.int64(16), 'Up': np.int64(218)}
Creating sequences from 84 data points...
Successfully created 24 sequences
Class distribution: {'Down': np.int64(13), 'Hold': np.int64(11)}
Creating sequences from 462 data points...
Successfully created 402 sequences
Class distribution: {'Down': np.int64(168), 'Hold': np.int64(16), 'Up': np.int64(218)}
Creating sequences from 84 data points...
Successfully created 24 sequences
Class distribution: {'Down': np.int64(13), 'Hold': np.int64(11)}
Creating standard TradingLSTM model
TradingLSTM: input_size=50, hidden_size=128
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for NVDA...
CACHE MISS: Running create_comprehensive_features and caching result.
PCA explained variance ratio: 0.999
✅ Generated 50 features for NVDA
📊 Backtesting NVDA...
Creating sequences from 462 data points...
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for NVDA...
CACHE MISS: Running create_comprehensive_features and caching result.
PCA explained variance ratio: 0.999
✅ Generated 50 features for NVDA
Successfully created 402 sequences
Class distribution: {'Down': np.int64(193), 'Hold': np.int64(15), 'Up': np.int64(194)}
Creating sequences from 84 data points...
Successfully created 24 sequences
Class distribution: {'Down': np.int64(12), 'Hold': np.int64(1), 'Up': np.int64(11)}
Creating sequences from 462 data points...
Successfully created 402 sequences
Class distribution: {'Down': np.int64(193), 'Hold': np.int64(15), 'Up': np.int64(194)}
Creating sequences from 84 data points...
Successfully created 24 sequences
Class distribution: {'Down': np.int64(12), 'Hold': np.int64(1), 'Up': np.int64(11)}
Creating standard TradingLSTM model
TradingLSTM: input_size=50, hidden_size=128
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for AMD...
CACHE MISS: Running create_comprehensive_features and caching result.
PCA explained variance ratio: 0.999
✅ Generated 50 features for AMD
📊 Backtesting AMD...
CACHE MISS: Running process_features and caching result.
Creating sequences from 462 data points...
🔧 Engineering features for AMD...
CACHE MISS: Running create_comprehensive_features and caching result.
Successfully created 402 sequences
PCA explained variance ratio: 1.000
✅ Generated 50 features for AMD
Class distribution: {'Down': np.int64(245), 'Hold': np.int64(12), 'Up': np.int64(145)}
Creating sequences from 84 data points...
Successfully created 24 sequences
Class distribution: {'Down': np.int64(12), 'Hold': np.int64(12)}
Creating sequences from 462 data points...
Successfully created 402 sequences
Class distribution: {'Down': np.int64(245), 'Hold': np.int64(12), 'Up': np.int64(145)}
Creating sequences from 84 data points...
Successfully created 24 sequences
Class distribution: {'Down': np.int64(12), 'Hold': np.int64(12)}
Creating standard TradingLSTM model
TradingLSTM: input_size=50, hidden_size=128
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for UVXY...
CACHE MISS: Running create_comprehensive_features and caching result.
PCA explained variance ratio: 1.000
✅ Generated 50 features for UVXY
📊 Backtesting UVXY...
Creating sequences from 462 data points...
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for UVXY...
CACHE MISS: Running create_comprehensive_features and caching result.
Successfully created 402 sequences
PCA explained variance ratio: 0.997
✅ Generated 50 features for UVXY
Class distribution: {'Down': np.int64(181), 'Hold': np.int64(14), 'Up': np.int64(207)}
Creating sequences from 84 data points...
Successfully created 24 sequences
Class distribution: {'Down': np.int64(14), 'Hold': np.int64(1), 'Up': np.int64(9)}
Creating sequences from 462 data points...
Successfully created 402 sequences
Class distribution: {'Down': np.int64(181), 'Hold': np.int64(14), 'Up': np.int64(207)}
Creating sequences from 84 data points...
Successfully created 24 sequences
Class distribution: {'Down': np.int64(14), 'Hold': np.int64(1), 'Up': np.int64(9)}
Creating standard TradingLSTM model
TradingLSTM: input_size=50, hidden_size=128
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for SOXL...
CACHE MISS: Running create_comprehensive_features and caching result.
PCA explained variance ratio: 0.999
✅ Generated 50 features for SOXL
📊 Backtesting SOXL...
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for SOXL...
Creating sequences from 462 data points...
CACHE MISS: Running create_comprehensive_features and caching result.
Successfully created 402 sequences
PCA explained variance ratio: 0.999
✅ Generated 50 features for SOXL
Class distribution: {'Down': np.int64(226), 'Hold': np.int64(12), 'Up': np.int64(164)}
Creating sequences from 84 data points...
Successfully created 24 sequences
Class distribution: {'Down': np.int64(12), 'Hold': np.int64(12)}
Creating sequences from 462 data points...
Successfully created 402 sequences
Class distribution: {'Down': np.int64(226), 'Hold': np.int64(12), 'Up': np.int64(164)}
Creating sequences from 84 data points...
Successfully created 24 sequences
Class distribution: {'Down': np.int64(12), 'Hold': np.int64(12)}
Creating standard TradingLSTM model
TradingLSTM: input_size=50, hidden_size=128
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for SQQQ...
CACHE MISS: Running create_comprehensive_features and caching result.
PCA explained variance ratio: 0.999
✅ Generated 50 features for SQQQ
📊 Backtesting SQQQ...
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for SQQQ...
CACHE MISS: Running create_comprehensive_features and caching result.
Creating sequences from 462 data points...
Successfully created 402 sequences
PCA explained variance ratio: 0.997
Class distribution: {'Down': np.int64(163), 'Hold': np.int64(17), 'Up': np.int64(222)}
✅ Generated 50 features for SQQQ
Creating sequences from 84 data points...
Successfully created 24 sequences
Class distribution: {'Down': np.int64(11), 'Hold': np.int64(1), 'Up': np.int64(12)}
Creating sequences from 462 data points...
Successfully created 402 sequences
Class distribution: {'Down': np.int64(163), 'Hold': np.int64(17), 'Up': np.int64(222)}
Creating sequences from 84 data points...
Successfully created 24 sequences
Class distribution: {'Down': np.int64(11), 'Hold': np.int64(1), 'Up': np.int64(12)}
Creating standard TradingLSTM model
TradingLSTM: input_size=50, hidden_size=128
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for TQQQ...
CACHE MISS: Running create_comprehensive_features and caching result.
PCA explained variance ratio: 0.996
✅ Generated 50 features for TQQQ
📊 Backtesting TQQQ...
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for TQQQ...
CACHE MISS: Running create_comprehensive_features and caching result.
Creating sequences from 462 data points...
Successfully created 402 sequences
PCA explained variance ratio: 0.998
✅ Generated 50 features for TQQQ
Class distribution: {'Down': np.int64(193), 'Hold': np.int64(8), 'Up': np.int64(201)}
Creating sequences from 84 data points...
Successfully created 24 sequences
Class distribution: {'Down': np.int64(12), 'Hold': np.int64(12)}
Creating sequences from 462 data points...
Successfully created 402 sequences
Class distribution: {'Down': np.int64(193), 'Hold': np.int64(8), 'Up': np.int64(201)}
Creating sequences from 84 data points...
Successfully created 24 sequences
Class distribution: {'Down': np.int64(12), 'Hold': np.int64(12)}
Creating standard TradingLSTM model
TradingLSTM: input_size=50, hidden_size=128
CACHE MISS: Running process_features and caching result.
🔧 Engineering features for TSLA...
CACHE MISS: Running create_comprehensive_features and caching result.
PCA explained variance ratio: 0.999
✅ Generated 50 features for TSLA
📊 Backtesting TSLA...
📊 Current columns for SPXS: ['open', 'high', 'low', 'close', 'volume']
📊 Backtest data shape for SPXS: (84, 55)
📊 Backtest columns: ['Open', 'High', 'Low', 'Close', 'Volume', 'pca_0', 'pca_1', 'pca_2', 'pca_3', 'pca_4']...
Backtest.run:   0% 0/83 [00:00<?, ?bar/s]CACHE MISS: Running process_features and caching result.
🔧 Engineering features for TSLA...
CACHE MISS: Running create_comprehensive_features and caching result.
PCA explained variance ratio: 1.000
✅ Generated 50 features for TSLA
                                         📊 Fetching data for SPY...
📊 Current columns for NVDA: ['open', 'high', 'low', 'close', 'volume']
📊 Backtest data shape for NVDA: (84, 55)
📊 Backtest columns: ['Open', 'High', 'Low', 'Close', 'Volume', 'pca_0', 'pca_1', 'pca_2', 'pca_3', 'pca_4']...
Backtest.run:   0% 0/83 [00:00<?, ?bar/s]                                         📊 Fetching data for SPY...
📊 Current columns for AMD: ['open', 'high', 'low', 'close', 'volume']
📊 Backtest data shape for AMD: (84, 55)
📊 Backtest columns: ['Open', 'High', 'Low', 'Close', 'Volume', 'pca_0', 'pca_1', 'pca_2', 'pca_3', 'pca_4']...
Backtest.run:   0% 0/83 [00:00<?, ?bar/s]                                         📊 Fetching data for SPY...
📊 Current columns for UVXY: ['open', 'high', 'low', 'close', 'volume']
📊 Backtest data shape for UVXY: (84, 55)
📊 Backtest columns: ['Open', 'High', 'Low', 'Close', 'Volume', 'pca_0', 'pca_1', 'pca_2', 'pca_3', 'pca_4']...
Backtest.run:   0% 0/83 [00:00<?, ?bar/s]                                         📊 Fetching data for SPY...
📊 Current columns for SOXL: ['open', 'high', 'low', 'close', 'volume']
📊 Backtest data shape for SOXL: (84, 55)
📊 Backtest columns: ['Open', 'High', 'Low', 'Close', 'Volume', 'pca_0', 'pca_1', 'pca_2', 'pca_3', 'pca_4']...
Backtest.run:   0% 0/83 [00:00<?, ?bar/s]                                         📊 Fetching data for SPY...
📊 Current columns for SQQQ: ['open', 'high', 'low', 'close', 'volume']
📊 Backtest data shape for SQQQ: (84, 55)
📊 Backtest columns: ['Open', 'High', 'Low', 'Close', 'Volume', 'pca_0', 'pca_1', 'pca_2', 'pca_3', 'pca_4']...
Backtest.run:   0% 0/83 [00:00<?, ?bar/s]                                         📊 Fetching data for SPY...
📊 Current columns for TQQQ: ['open', 'high', 'low', 'close', 'volume']
📊 Backtest data shape for TQQQ: (84, 55)
📊 Backtest columns: ['Open', 'High', 'Low', 'Close', 'Volume', 'pca_0', 'pca_1', 'pca_2', 'pca_3', 'pca_4']...
Backtest.run:   0% 0/83 [00:00<?, ?bar/s]                                         📊 Fetching data for SPY...
📊 Current columns for TSLA: ['open', 'high', 'low', 'close', 'volume']
📊 Backtest data shape for TSLA: (84, 55)
📊 Backtest columns: ['Open', 'High', 'Low', 'Close', 'Volume', 'pca_0', 'pca_1', 'pca_2', 'pca_3', 'pca_4']...
Backtest.run:   0% 0/83 [00:00<?, ?bar/s]                                         📊 Fetching data for SPY...
✅ Fetched 690 rows for SPY
Backtest.run:   0% 0/83 [00:00<?, ?bar/s]                                         ✅ Fetched 690 rows for SPY
Backtest.run:   0% 0/83 [00:00<?, ?bar/s]                                         ✅ Fetched 690 rows for SPY
Backtest.run:   0% 0/83 [00:00<?, ?bar/s]                                         ✅ Fetched 690 rows for SPY
Backtest.run:   0% 0/83 [00:00<?, ?bar/s]                                         ✅ Fetched 690 rows for SPY
Backtest.run:   0% 0/83 [00:00<?, ?bar/s]                                         ✅ Fetched 690 rows for SPY
Backtest.run:   0% 0/83 [00:00<?, ?bar/s]                                         ✅ Fetched 690 rows for SPY
Backtest.run:   0% 0/83 [00:00<?, ?bar/s]                                         ✅ Fetched 690 rows for SPY
Backtest.run:   0% 0/83 [00:00<?, ?bar/s]                                         💾 Reports saved: /workspace/model_res/ultimate/ultimate_report_20250910_021709.json, /workspace/model_res/ultimate/ultimate_report_20250910_021709.md

🎉 Analysis Complete!
✅ Trainings: 9/9
✅ Backtests: 9/9
⏱️ Runtime: 3157.24s
📊 Avg Accuracy: 0.4120
📈 Avg Ann Return: 0.0133
📉 Avg Sharpe: 0.1024
